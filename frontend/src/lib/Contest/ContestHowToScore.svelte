<script lang="ts">
	import Button from '$lib/InputComponents/Button.svelte';
	import { contest } from '$lib/stores/contests';
	import { user } from '$lib/stores/user';
	import Tooltip from '$lib/Utility/Tooltip.svelte';

	export let score: any = [];
	export let userScore: any = [];
	export let type: string = 'DEADLINE';
</script>

<section id="how_to_score" class="container {type === 'DEADLINE' ? 'deadline' : 'score'}">
	<div class="header">
		<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
			<path
				d="M12 16C11.2044 16 10.4413 15.6839 9.87868 15.1213C9.31607 14.5587 9 13.7956 9 13C9 11.88 9.61 10.9 10.5 10.39L20.21 4.77L14.68 14.35C14.18 15.33 13.17 16 12 16ZM12 3C13.81 3 15.5 3.5 16.97 4.32L14.87 5.53C14 5.19 13 5 12 5C9.87827 5 7.84344 5.84285 6.34315 7.34315C4.84285 8.84344 4 10.8783 4 13C4 15.21 4.89 17.21 6.34 18.65H6.35C6.74 19.04 6.74 19.67 6.35 20.06C5.96 20.45 5.32 20.45 4.93 20.07C3.12 18.26 2 15.76 2 13C2 10.3478 3.05357 7.8043 4.92893 5.92893C6.8043 4.05357 9.34784 3 12 3ZM22 13C22 15.76 20.88 18.26 19.07 20.07C18.68 20.45 18.05 20.45 17.66 20.06C17.27 19.67 17.27 19.04 17.66 18.65C19.11 17.2 20 15.21 20 13C20 12 19.81 11 19.46 10.1L20.67 8C21.5 9.5 22 11.18 22 13Z"
				fill="black"
			/>
		</svg>
		<p>How to score</p>
	</div>
	<div class="wrapper">
		{#each score as criteria, index}
			<div class="block">
				<div class="info">
					<div class="icon">
						<svg
							width="40"
							height="40"
							viewBox="0 0 40 40"
							fill="none"
							xmlns="http://www.w3.org/2000/svg"
						>
							<rect
								width="40"
								height="40"
								rx="20"
								fill={type === 'DEALINE' ? 'var(--green4)' : 'var(--purple4)'}
							/>
							<g clip-path="url(#clip0_1359_59041)">
								<path
									fill-rule="evenodd"
									clip-rule="evenodd"
									d="M12.504 22.8787C12.5038 23.0293 12.5036 23.1799 12.5036 23.3305C12.5036 23.4682 12.5037 23.6058 12.5038 23.7434C12.504 24.0873 12.5042 24.4309 12.5031 24.7742C12.5021 25.0216 12.5057 25.268 12.5625 25.5107C12.7307 26.2279 13.1641 26.768 13.7187 27.2221C14.5005 27.8617 15.4083 28.256 16.3641 28.5482C17.6469 28.9404 18.964 29.1154 20.3015 29.1523C22.0021 29.1997 23.6786 29.0435 25.312 28.5466C26.3385 28.2346 27.3068 27.8023 28.1182 27.0773C28.8125 26.457 29.1974 25.7029 29.1724 24.7456C29.1555 24.1054 29.1594 23.4646 29.1633 22.8238C29.1651 22.5339 29.1668 22.2441 29.1667 21.9544C29.1667 21.9268 29.1671 21.8991 29.1676 21.8714C29.1689 21.7946 29.1702 21.7178 29.1614 21.6424C29.0328 20.5195 28.4838 19.669 27.5 19.1075C27.4135 19.0581 27.3812 19.0226 27.4125 18.9164C27.4745 18.7039 27.4989 18.4841 27.4984 18.2612C27.4963 17.1945 27.4969 16.1273 27.4979 15.0601C27.4979 14.8643 27.4792 14.6716 27.4349 14.4805C27.2698 13.769 26.8385 13.2346 26.2911 12.7831C25.5745 12.1919 24.7458 11.8107 23.8703 11.5232C22.5198 11.0794 21.1276 10.8877 19.7109 10.8466C17.9578 10.7956 16.2307 10.9633 14.5521 11.4956C13.5672 11.8081 12.6385 12.2362 11.8625 12.9393C11.1833 13.5544 10.8057 14.2992 10.8292 15.2414C10.8453 15.8817 10.8418 16.5228 10.8383 17.1639C10.8366 17.4729 10.8349 17.7819 10.8354 18.0909C10.8354 18.2075 10.8391 18.3252 10.8542 18.4409C10.9963 19.5336 11.551 20.3513 12.5042 20.8987C12.5927 20.9497 12.6172 20.993 12.5854 21.094C12.5187 21.306 12.5016 21.5263 12.5026 21.7492C12.5048 22.1257 12.5044 22.5022 12.504 22.8787ZM23.8104 13.2851C22.3171 12.7034 20.7567 12.5153 19.1677 12.5028C18.7895 12.4935 18.4125 12.5159 18.0369 12.5435C16.7671 12.6372 15.5255 12.8622 14.3453 13.3601C13.7677 13.6039 13.2151 13.8935 12.7921 14.3731C12.4036 14.8138 12.4088 15.1966 12.7979 15.6388C13.1125 15.9966 13.5088 16.2435 13.9302 16.4523C15.0078 16.9872 16.1599 17.2554 17.3468 17.3929C19.2125 17.6086 21.0604 17.5247 22.8781 17.0289C23.7531 16.7898 24.5948 16.4664 25.3015 15.8726C25.9984 15.2872 25.9979 14.7284 25.3099 14.1377C24.8656 13.756 24.351 13.4955 23.8104 13.2851ZM19.6536 22.4935C17.7911 22.5586 15.9703 22.3232 14.1703 21.7054C14.1994 21.9304 14.289 22.0914 14.4073 22.2388C14.688 22.5924 15.0541 22.8388 15.4468 23.0461C16.6807 23.6976 18.0177 23.97 19.3906 24.0992C20.5807 24.2112 21.7692 24.1867 22.9531 24.0205C24.0583 23.8653 25.1323 23.5992 26.1317 23.0856C26.5854 22.8528 27.0151 22.5825 27.3171 22.1565C27.5609 21.8133 27.5593 21.5086 27.3197 21.1643C27.1114 20.8648 26.8213 20.6565 26.5197 20.4601C26.4484 20.4136 26.412 20.4461 26.371 20.4827C26.3657 20.4875 26.3603 20.4923 26.3546 20.4971C25.9093 20.8726 25.4125 21.1659 24.8838 21.4054C23.2224 22.1596 21.4588 22.4304 19.6536 22.4935ZM14.1729 24.2304C14.2775 24.2821 14.3798 24.3335 14.4808 24.3842L14.4811 24.3844C14.6939 24.4913 14.901 24.5953 15.1114 24.6924C16.8875 25.5133 18.7536 25.881 20.7099 25.8367C20.8766 25.8329 21.0433 25.8309 21.2099 25.8288L21.2104 25.8288C21.7584 25.822 22.3058 25.8152 22.852 25.7481C24.4296 25.5549 25.914 25.0752 27.3109 24.319C27.3522 24.2968 27.3937 24.2752 27.4426 24.2498L27.4429 24.2496C27.4593 24.2411 27.4765 24.2322 27.4947 24.2226C27.4947 24.3123 27.4958 24.3999 27.4969 24.4862C27.4993 24.6817 27.5016 24.87 27.4911 25.0575C27.4786 25.2794 27.3567 25.4617 27.2119 25.6247C26.8093 26.0773 26.2927 26.3612 25.7484 26.6008C24.7036 27.0601 23.601 27.294 22.4729 27.4122C21.1078 27.5554 19.7448 27.5278 18.3885 27.3018C17.3005 27.1205 16.2463 26.8315 15.2812 26.2778C14.9698 26.0992 14.6807 25.8898 14.4448 25.6148C14.2546 25.394 14.1515 25.1461 14.1708 24.8476C14.179 24.7117 14.177 24.5748 14.1748 24.4325C14.1739 24.3665 14.1729 24.2993 14.1729 24.2304ZM12.5717 17.5906L12.5036 17.5549C12.5036 17.6065 12.5052 17.6552 12.5068 17.7017C12.51 17.7965 12.5129 17.8824 12.501 17.9659C12.4166 18.5648 12.7145 18.97 13.1593 19.308C13.6609 19.6893 14.2234 19.9508 14.814 20.157C16.3432 20.6914 17.925 20.8575 19.5343 20.8242C21.0125 20.7935 22.4583 20.582 23.8416 20.0372C24.4359 19.8034 25.0026 19.5153 25.4604 19.0534C25.6317 18.881 25.7937 18.6903 25.814 18.4409C25.83 18.2445 25.8262 18.0461 25.8225 17.8466V17.8464C25.8209 17.7592 25.8192 17.6717 25.8192 17.5841C25.7526 17.5845 25.7026 17.616 25.654 17.6467C25.6376 17.6571 25.6213 17.6673 25.6046 17.6763C24.2479 18.407 22.8062 18.8695 21.2781 19.0737C20.5316 19.1733 19.783 19.1751 19.0339 19.177C18.9446 19.1772 18.8554 19.1774 18.7661 19.1778C16.9614 19.1856 15.2328 18.8304 13.5828 18.0945C13.2459 17.9439 12.919 17.7726 12.5717 17.5906Z"
									fill={type === 'DEALINE' ? 'var(--green1)' : 'var(--purple1)'}
								/>
							</g>
							<defs>
								<clipPath id="clip0_1359_59041">
									<rect width="20" height="20" fill="white" transform="translate(10 10)" />
								</clipPath>
							</defs>
						</svg>
					</div>
					<div class="points">
						<svg
							width="20"
							height="20"
							viewBox="0 0 20 20"
							fill="none"
							xmlns="http://www.w3.org/2000/svg"
						>
							<path
								fill-rule="evenodd"
								clip-rule="evenodd"
								d="M5.4537 10.8782C5.0537 10.8115 4.6537 10.7199 4.2537 10.6115C3.79537 10.4782 3.3537 10.2865 2.9287 9.99486C2.8537 9.93652 2.77037 9.87819 2.67037 9.81152C2.67037 9.86152 2.6787 11.3782 2.67037 12.0949C2.66204 12.4365 2.77037 12.6865 2.96204 12.8949C3.1787 13.1282 3.43704 13.2949 3.7037 13.4282C4.17037 13.6615 4.66204 13.8115 5.17037 13.9115C5.64537 14.0032 6.12037 14.0615 6.6037 14.0782C6.8787 14.0865 7.1537 14.0865 7.4287 14.0699V13.9365L7.42037 12.6699V12.6199C7.42037 12.5115 7.4287 12.3782 7.42037 12.2365C7.4287 12.0032 7.4287 11.7365 7.4287 11.4782V10.9782C7.24537 10.9949 7.0537 10.9949 6.87037 10.9949C6.39537 10.9949 5.92037 10.9615 5.4537 10.8782Z"
								fill="black"
							/>
							<path
								fill-rule="evenodd"
								clip-rule="evenodd"
								d="M5.61159 6.66152C5.10326 6.58652 4.60326 6.47819 4.10326 6.31152C3.71159 6.18652 3.32826 6.01986 2.96992 5.77819C2.87826 5.71152 2.77826 5.63652 2.66992 5.56152C2.66992 5.61152 2.67826 7.14486 2.66992 7.87819C2.66992 8.15319 2.74492 8.37816 2.89492 8.56982C3.12826 8.85316 3.40326 9.02816 3.69492 9.17816C4.11992 9.40316 4.56159 9.53649 5.01159 9.63649C5.44492 9.73649 5.88659 9.80316 6.33659 9.82816C6.70326 9.85316 7.06992 9.86149 7.42826 9.84482L7.41992 7.95319L7.44492 7.96986C7.40326 7.61986 7.45326 7.17819 7.71992 6.71986C7.01992 6.77819 6.31159 6.75319 5.61159 6.66152Z"
								fill="black"
							/>
							<path
								fill-rule="evenodd"
								clip-rule="evenodd"
								d="M2.95063 4.40211C3.1998 4.68378 3.49563 4.85795 3.8023 5.00378C4.3548 5.26628 4.9298 5.41045 5.51313 5.50378C6.0048 5.58211 6.4998 5.62211 6.89813 5.61461C7.82897 5.61628 8.65401 5.52378 9.46651 5.28128C9.87151 5.16045 10.2665 5.00295 10.6373 4.75461C10.8407 4.61795 11.0307 4.45795 11.1773 4.22545C11.3723 3.91711 11.3748 3.55795 11.1773 3.25378C11.1098 3.14961 11.0315 3.05378 10.9473 2.97211C10.6323 2.66711 10.269 2.48961 9.89568 2.34295C9.23151 2.08211 8.54818 1.95461 7.8573 1.89628C6.91563 1.81711 5.97647 1.85711 5.04397 2.06295C4.5373 2.17378 4.04063 2.32961 3.56813 2.59378C3.31563 2.73461 3.0748 2.90211 2.88147 3.16045C2.72063 3.37545 2.62647 3.62045 2.69397 3.92711C2.7373 4.12211 2.8348 4.27128 2.95063 4.40211Z"
								fill="black"
							/>
							<path
								fill-rule="evenodd"
								clip-rule="evenodd"
								d="M17.3298 13.8477C17.2948 13.8743 17.2764 13.8893 17.2573 13.901C17.0539 14.0318 16.8557 14.1785 16.6448 14.2885C15.9007 14.6793 15.1182 14.8618 14.3223 14.9685C13.8398 15.0335 13.3565 15.0543 12.8715 15.0502C12.3965 15.0468 11.9232 15.0177 11.454 14.9352C11.0548 14.8643 10.6565 14.7718 10.2615 14.6635C9.80066 14.5352 9.354 14.3427 8.9365 14.051C8.854 13.9927 8.7715 13.9318 8.6765 13.8635C8.6765 13.9135 8.684 15.4302 8.674 16.1535C8.669 16.4893 8.77566 16.7377 8.96483 16.946C9.184 17.1877 9.43816 17.3485 9.704 17.4827C10.1782 17.7202 10.6698 17.8627 11.1707 17.9652C11.6465 18.0618 12.124 18.116 12.604 18.1335C13.4315 18.1635 14.2548 18.1068 15.0707 17.9143C15.5398 17.8035 15.9998 17.6543 16.4373 17.4077C16.6873 17.2668 16.9247 17.1002 17.1182 16.846C17.2598 16.6602 17.334 16.4443 17.3315 16.1777C17.3265 15.4402 17.3298 13.901 17.3298 13.8477Z"
								fill="black"
							/>
							<path
								fill-rule="evenodd"
								clip-rule="evenodd"
								d="M8.90139 12.6255C9.12805 12.9097 9.40555 13.0872 9.69555 13.2364C10.1206 13.4547 10.5622 13.5922 11.0122 13.6947C11.4514 13.7955 11.8939 13.8572 12.3389 13.8864C13.1989 13.9422 14.0547 13.8964 14.9056 13.7155C15.4231 13.6047 15.9314 13.4489 16.4147 13.1814C16.6731 13.0389 16.9197 12.868 17.1197 12.6055C17.2589 12.4222 17.3331 12.2097 17.3314 11.9447C17.3256 11.2022 17.3264 9.65802 17.3247 9.62052C17.2264 9.69052 17.1397 9.75802 17.0489 9.81802C16.3481 10.288 15.5881 10.5039 14.8131 10.643C14.4522 10.708 14.0881 10.7464 13.7239 10.7772C13.0197 10.8364 12.3164 10.8089 11.6147 10.7147C11.1072 10.6464 10.6039 10.5372 10.1097 10.3705C9.71722 10.2397 9.33555 10.0764 8.97639 9.83219C8.87972 9.76552 8.78472 9.69469 8.67639 9.61719C8.67639 9.66635 8.68055 11.1997 8.67389 11.9314C8.67139 12.2122 8.74972 12.4355 8.90139 12.6255Z"
								fill="black"
							/>
							<path
								fill-rule="evenodd"
								clip-rule="evenodd"
								d="M9.57154 6.64984C9.31904 6.79067 9.07904 6.95817 8.88571 7.21651C8.72488 7.43067 8.62988 7.67567 8.69821 7.98317C8.74071 8.17734 8.83904 8.32734 8.95404 8.45817C9.20321 8.73901 9.49904 8.91401 9.80571 9.05984C10.359 9.32234 10.934 9.46651 11.5165 9.55984C12.009 9.63817 12.5032 9.67817 12.9015 9.67067C13.8324 9.67234 14.6574 9.57901 15.4699 9.33734C15.8749 9.21651 16.2707 9.05817 16.6407 8.80984C16.844 8.67401 17.0349 8.51401 17.1815 8.28151C17.3757 7.97234 17.379 7.61401 17.1815 7.30984C17.1132 7.20567 17.0349 7.10984 16.9507 7.02817C16.6357 6.72234 16.2724 6.54484 15.899 6.39901C15.2349 6.13817 14.5515 6.00984 13.8615 5.95234C12.919 5.87234 11.9799 5.91317 11.0474 6.11817C10.5415 6.22984 10.044 6.38567 9.57154 6.64984Z"
								fill="black"
							/>
						</svg>
						<p>{criteria.points} {criteria.points > 1 ? 'points': 'point'}</p>
					</div>
					<p class="secondary_text">For every</p>
					<div class="action">
						<p class="action">
							{criteria.number > 1 ? criteria.number : ''}
							{criteria.measuring_unit}
						</p>
						{#if criteria.description}
							<Tooltip tooltip={criteria.description} />
						{/if}
					</div>
				</div>
				{#if $user}
					<div class="userscore">
						<div class="scoreblock">
							<p class="label">Your points:</p>
							<p class="value">
								{$contest.participants
									.find((p) => p._id == $user?._id)
									?.score.find((s) => s.category == criteria._id).points
									? $contest.participants
											.find((p) => p._id == $user._id)
											?.score.find((s) => s.category == criteria._id).points
									: 0}
							</p>
						</div>
					</div>
				{/if}
			</div>
		{/each}
	</div>
</section>

<style>
	.container {
		width: 100%;
		padding: 0 20px;
		overflow: hidden;
	}
	.header {
		display: flex;
		align-items: center;
		margin-bottom: 20px;
	}
	.header p {
		font-size: 1.3rem;
		font-weight: 600;
		margin-left: 10px;
	}
	.wrapper {
		width: fit-content;
		display: flex;
		flex-wrap: wrap;
		gap: 20px;
	}
	.block {
		width: 100%;
		max-width: 250px;
		min-width: 250px;
		padding: 16px;
		border-radius: 8px;
		border: 1px solid var(--gray3);
	}
	.info {
		display: flex;
		align-items: center;
		margin-bottom: 10px;
		gap: 5px;
		flex-direction: column;
	}
	.action {
		display: flex;
		align-items: center;
		gap: 5px;
	}
	.action p {
		font-size: 1.2rem;
		font-weight: 600;
		margin-left: 8px;
	}
	.points {
		display: flex;
		align-items: center;
		justify-content: center;
		gap: 5px;
		padding: 4px;
		width: 100%;
		border-radius: 7px;
		background-color: var(--gray4);
	}
	.points p {
		font-size: 1.15rem;
		font-weight: 600;
	}

	.userscore {
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 5px;
		margin-top: 10px;
		border-top: 1px solid var(--gray3);
		padding-top: 10px;
	}
	.scoreblock {
		display: flex;
		width: 100%;
		align-items: center;
		justify-content: space-between;
		gap: 5px;
	}

	@media screen and (max-width: 768px) {
		.container {
			padding: 0;
		}
		.wrapper {
			width: 100%;
			display: flex;
			flex-direction: column;
		}
		.block {
			max-width: unset;
			min-width: unset;
			width: 100%;
		}
	}
</style>
